# Project structure

-   `start.py`: executable script implementing commands that can transform or
    analyze images accordingly

-   `images/`: contains source images to be ranked according to different
    metrics

    -   `<category>/`\*: contains a certain category of image. For example,
        'brick,' 'wheat,' etc.
        -   `orig.jpg`: the original image; everything else in this directory
            is derived from this image.
        -   `output.jpg`: the output image without being transformed with any
            specific transformation.
        -   `<transformation>/`\*: contains images that are transformed from
            the original image with a certain transformation. For example,
            'crop,' 'watermark,' etc.
            -   `level_[0-10].jpg`\*: images transformed with different
                intensity with the particular `<transformation>`. Level 0 is
                identical to `output.jpg`, and Level 10 is the most
                transformed.

-   `printables/`: contains the transformed images in printable format
    (currently only pdf format)

    -   `<category>_<transformation>.pdf`\*: the file containing all levels of
        transformed images in `<category>` transformed using `<transformation>`

-   `data/`: contains ranking data

	-   `sequence/`: contains sequence related data
		-   `sequences.json`: existing sequence mappings. Data has the
			[following structure](#sequence-data-structure)

	-   `sort/`
		-   `humans/`: contains human sorted data, converted from manually
			typed data.

			-   `<id>.csv`\*: data collected from person associated with `<id>`.
				Data has the [following structure](#sorted-data-structure)

		-   `metrics/`: contains computer ranked data, automatically generated by
			the `analyze` command
			-   `<metric>.csv`\*: data generated by `<metric>`. E.g. MSE. Data
				has the [following structure](#sorted-data-structure)
	-   `rank/`
		-   `standard.csv`: Spearman's rank correlation against the standard
			order, grouped by metrics and category-transformation. Data has the
			the [following structure](#ranked-data-structure)
		-   `human.csv`: Spearman's rank correlation against human ranked
			order, not implemented.

-   `src/`: contains source code

    -   `transformations/`: contains code to transform images

        -   `<transformation>/`\*: represents a transformation. For example,
            blur.
            -   `__init__.py`: contains a `transform(img, level): img` public
                function to transform a given image with the given `level`. The
                function should ensure that when `level` is 0, the image
                returned is identical to the image passed to it.

    -   `analysis/`: contains code to calculate ranks based on different
        metrics

        -   `<metric>/`\*: represents a metric. For example, MSE.
            -   `__init__.py`: contains a class definition of subclass derived
                from the `Analyzer` class, with a method `rate(orig, comp): float` to calculate the difference rating according to
                `<metric>`.

-   `env.sh`: to be sourced before running the project

> __Legends__:

> Each list item is either a directory or a file, or multiple
> directories/files, if they are followed with a asterisk ("\*") sign

> Each list item has two parts, separated by a colon (":"), the part before
> the colon is the name of the directory or the file, while the part after
> the colon is a description for the directory or the file.

> `directory/` names are followed by a slash, while `file` names are not
> followed by a slash.

> sub-directories and files for a given directory are nested below the
> given directory.

> if a name of a directory or a file contains a word surrounded by angle
> bracket (`<placeholder>`), the word is a placeholder that can be replaced
> by specific names according to the description.

# CSV file structures

## sorted data structure
| dataset                       | 1   | 2   | ... |
| ----------------------------- | --- | --- | --- |
| `<category>_<transformation>` | 4   | 2   | ... |
| `<category>_<transformation>` | ... | ... | ... |
| `<category>_<transformation>` | ... | ... | ... |
| ...                           | ... | ... | ... |

> the first row contains the reference sequence, ordered according to their
> level of distortion, where the first item is the most similar to the
> reference image, and the last is the least similar.

> `<category>_<transformation>` represents a dataset of a
> category-transformation, for example, "wheat\_blur" means the images in the
> "wheat" category that is transformed using the "blur" transformation.

> the numbers in each row correspond to the level to which each image is
> transformed. For example, the "4" under the (1) column means that the image
> with a transformation level of 4 (with a name similar to "level\_04.jpg") is
> rated to be the most similar to the reference image.

> in human rated data, the numbers can also be arbitrary symbols, as long as
> the symbols are consistent across different rows.

## ranked data structure
| agent        | `<category>_<transformation>` | `<category>_<transformation>` | ... |
| ------------ | ----------------------------- | ----------------------------- | --- |
| `<agent1>_r` | 0.8                           | 1                             | ... |
| `<agent1>_p` | 0.002                         | 0                             | ... |
| `<agent2>_r` | ...                           | ...                           | ... |
| `<agent2>_p` | ...                           | ...                           | ... |
| ...          | ...                           | ...                           | ... |

> since Spearman's rank has both the coefficient and p-value as result, each
> agent will occupy two rows instead of one row, whereas the first row contains
> the coefficients and the second row contains the p-value.

## sequence data structure

```
{
	"category#transformation": ['A', 'B', 'C', 'D', 'E', ...],
	...
}
```

> Each key-item pair in the json file represents the symbol sequence used to
> encode the transformed images, from the most similar to the least. 
